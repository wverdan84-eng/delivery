<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vitrine Online</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/beercss@3.4.13/dist/cdn/beer.min.css">
    <style>
        .product-card { border-radius: 15px; overflow: hidden; background: white; border: none; }
        .btn-zap { background: #25D366 !important; color: white !important; font-weight: bold; }
    </style>
</head>
<body>
    <header class="primary shadow"><nav class="center-align"><h5>üõçÔ∏è Cat√°logo Digital</h5></nav></header>

    <main class="responsive p-2">
        <div class="grid" id="lista"></div>
    </main>

    <script>
        const API_URL = "https://script.google.com/macros/s/AKfycbwrLu_HlF_VRrokiKPbFrMUQzaG1vl_HkXzmZ5HN1GZN4RgIzmYq3U6HXI1L1j3EcFC/exec";
        const urlParams = new URLSearchParams(window.location.search);
        const lojaEmail = urlParams.get('loja');

        async function carregar() {
            try {
                const res = await fetch(`${API_URL}?action=getProdutos&dono=${lojaEmail}`, {redirect: "follow"});
                const dados = await res.json();
                
                const produtos = dados.produtos;
                const whatsapp = dados.whatsapp; // N√∫mero din√¢mico da planilha

                document.getElementById('lista').innerHTML = produtos.map(p => {
                    const msg = encodeURIComponent(`Ol√°! Quero pedir: ${p.nome} (R$ ${parseFloat(p.preco).toFixed(2)})`);
                    const linkZap = `https://wa.me/${whatsapp}?text=${msg}`;
                    
                    return `
                    <div class="s12 m6 l4">
                        <div class="card product-card shadow">
                            <img src="${p.img || 'https://via.placeholder.com/400'}" class="responsive" style="height:200px; object-fit:cover">
                            <div class="padding">
                                <h6 class="bold">${p.nome}</h6>
                                <h5 class="green-text">R$ ${parseFloat(p.preco).toFixed(2)}</h5>
                                <a href="${linkZap}" target="_blank" class="button fill btn-zap full-width">
                                    <i>send</i> Pedir no WhatsApp
                                </a>
                            </div>
                        </div>
                    </div>`;
                }).join('');
            } catch (e) {
                console.error("Erro ao carregar vitrine");
            }
        }
        window.onload = carregar;
    </script>
</body>
</html>
